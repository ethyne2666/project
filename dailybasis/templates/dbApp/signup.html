
{% extends "dbApp/base.html" %}

{% load static %}

{% block content %}
<div class="login-container">
    <div class="login-card">
        <!-- Logo -->
        <div class="logo">
            <a href="{% url 'index' %}">
                <img src="{% static 'images/daily-basis.png' %}" alt="Daily Basis Logo">
            </a>
        </div>

        <!-- Heading -->
        <h2>Signin to Daily Basis</h2>

        <!-- Login Form -->
        <form method="POST" action="{% url 'signup' %}">
            {% csrf_token %}
            
            <div class="form-group">
                   <label for="username">User Name</label>
                   <input type="text" id="username" name="username" required placeholder="Enter your name">
                   <small id="username-status"></small>
              </div>


            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label for="phone">Phone</label>
                <input type="text" id="phone" name="phone" required placeholder="Enter your phone number">
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required placeholder="Enter your password">
            </div>
            <div class="form-group">
                <label for="confirm_password"> confirm Password</label>
                <input type="password" id="confirm_password" name="confirm_password" required placeholder="Confirm your password">
            </div>

            <button type="submit" class="btn-login">Signin</button>
        </form>

        <!-- Extra Options -->
        <p class="signup-text">
            Already have an account?
            <a href="{% url 'login' %}">Login here</a>
        </p>
    </div>
</div>




<script>
document.addEventListener("DOMContentLoaded", function() {
    const usernameInput = document.getElementById("username");
    const statusMsg = document.getElementById("username-status");
    const submitBtn = document.querySelector(".btn-login");

    usernameInput.addEventListener("input", function() {
        const username = usernameInput.value.trim();
        if (username.length < 3) {
            statusMsg.textContent = "Username must be at least 3 characters.";
            statusMsg.style.color = "red";
            submitBtn.disabled = true;
            return;
        }

        fetch(`/check-username/?username=${username}`)
            .then(response => response.json())
            .then(data => {
                if (data.exists) {
                    statusMsg.textContent = "❌ Username already taken";
                    statusMsg.style.color = "red";
                    submitBtn.disabled = true;
                } else {
                    statusMsg.textContent = "✅ Username available";
                    statusMsg.style.color = "green";
                    submitBtn.disabled = false;
                }
            })
            .catch(error => {
                console.error("Error checking username:", error);
            });
    });
});
</script>

{% endblock %}
